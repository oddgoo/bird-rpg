{% extends 'base.html' %}

{% block title %}Research | bird-rpg Village{% endblock %}

{% block content %}
<h2 class="text-center text-4xl text-navy-900 mb-8 font-mystical font-bold">üìî Research Progress</h2>

<!-- Author Studies Section (Active Event) -->
<div class="rounded-xl p-6 mb-8 shadow-lg border-4 border-purple-900" style="background-image: url('/static/images/ui/bg_purple_stones.png'); background-repeat: repeat;">
    <div class="">
        <h2 class="text-2xl text-center text-purple-900 mb-4 font-mystical font-bold">üîç Author Studies{% if active_event != 'default' %} <span class="text-lg">({{ active_event }})</span>{% endif %}</h2>
        <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-6">
            {% for author in authors %}
            <div class="rounded-xl p-4 shadow-lg flex flex-col" style="background-image: url('/static/images/ui/bg_purple_card.png'); background-color: black; background-repeat: repeat; background-size: 70%; ">
                <div class="w-full">
                    <h3 class="text-4xl font-bold text-yellow-200 mb-3 text-center w-full">{{ author.name }}</h3>

                    <div class="mb-4">
                        <div class="flex justify-between items-center mb-1">
                            <span class="text-sm font-medium text-white">Next Milestone Progress</span>
                            <span class="text-sm font-medium text-white">{{ author.current_points }}/{{ author.next_threshold }}</span>
                        </div>
                        <div class="w-full bg-gray-200 rounded-full h-2.5 overflow-hidden">
                            <div class="bg-amber-500 h-2.5 rounded-full" style="width: {{ author.progress_percent }}%"></div>
                        </div>
                        <div class="text-xs text-white mt-1 text-right">
                            {% if author.milestones_unlocked == author.milestones|length %}
                            All milestones unlocked!
                            {% else %}
                            {{ author.milestones_unlocked }} of {{ author.milestones|length }} milestones unlocked
                            {% endif %}
                        </div>
                    </div>

                    <div class="mt-3">
                        <ul class="space-y-1 ml-1 text-sm">
                            {% if author.milestones_unlocked > 0 %}
                            <li class="flex items-start text-white">
                                <span class="flex-shrink-0 mt-0.1 mr-2"><span class="text-green-600">‚úÖ</span></span>
                                <span>{{ author.milestones[author.milestones_unlocked - 1] }}</span>
                            </li>
                            {% endif %}
                            {% if author.milestones_unlocked < author.milestones|length %}
                            <li class="flex items-start text-white opacity-20">
                                <span class="flex-shrink-0 mt-0.1 mr-2"><span>‚¨ú</span></span>
                                <span>{{ author.milestones[author.milestones_unlocked] }}</span>
                            </li>
                            {% endif %}
                        </ul>
                    </div>
                </div>
            </div>
            {% endfor %}
        </div>
    </div>
</div>

<!-- Other Event Authors (collapsed) -->
{% if other_authors %}
<div class="rounded-xl p-6 mb-8 shadow-lg border-4 border-purple-700 opacity-80" style="background-image: url('/static/images/ui/bg_purple_stones.png'); background-repeat: repeat;">
    <details>
        <summary class="text-2xl text-center text-purple-900 mb-4 font-mystical font-bold cursor-pointer list-none">
            <span>üìú Other Event Authors ({{ other_authors|length }})</span>
        </summary>
        <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-6 mt-4">
            {% for author in other_authors %}
            <div class="rounded-xl p-4 shadow-lg flex flex-col" style="background-image: url('/static/images/ui/bg_purple_card.png'); background-color: black; background-repeat: repeat; background-size: 70%; ">
                <div class="w-full">
                    <h3 class="text-4xl font-bold text-yellow-200 mb-3 text-center w-full">{{ author.name }}</h3>

                    <div class="mb-4">
                        <div class="flex justify-between items-center mb-1">
                            <span class="text-sm font-medium text-white">Next Milestone Progress</span>
                            <span class="text-sm font-medium text-white">{{ author.current_points }}/{{ author.next_threshold }}</span>
                        </div>
                        <div class="w-full bg-gray-200 rounded-full h-2.5 overflow-hidden">
                            <div class="bg-amber-500 h-2.5 rounded-full" style="width: {{ author.progress_percent }}%"></div>
                        </div>
                        <div class="text-xs text-white mt-1 text-right">
                            {% if author.milestones_unlocked == author.milestones|length %}
                            All milestones unlocked!
                            {% else %}
                            {{ author.milestones_unlocked }} of {{ author.milestones|length }} milestones unlocked
                            {% endif %}
                        </div>
                    </div>

                    <div class="mt-3">
                        <ul class="space-y-1 ml-1 text-sm">
                            {% if author.milestones_unlocked > 0 %}
                            <li class="flex items-start text-white">
                                <span class="flex-shrink-0 mt-0.1 mr-2"><span class="text-green-600">‚úÖ</span></span>
                                <span>{{ author.milestones[author.milestones_unlocked - 1] }}</span>
                            </li>
                            {% endif %}
                            {% if author.milestones_unlocked < author.milestones|length %}
                            <li class="flex items-start text-white opacity-20">
                                <span class="flex-shrink-0 mt-0.1 mr-2"><span>‚¨ú</span></span>
                                <span>{{ author.milestones[author.milestones_unlocked] }}</span>
                            </li>
                            {% endif %}
                        </ul>
                    </div>
                </div>
            </div>
            {% endfor %}
        </div>
    </details>
</div>
{% endif %}

<!-- Birds in Progress Section -->
{% if birds_in_progress %}
<div class="rounded-xl p-6 mb-8 shadow-lg border-4 border-yellow-900" style="background-image: url('/static/images/papyrus.jpg'); background-repeat: repeat;">
    <div class="border border-amber-300/50 rounded-lg p-4">
        <h2 class="text-2xl text-center text-yellow-900 mb-4 font-mystical font-bold">üê¶ Birds Being Manifested</h2>
        <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4">
            {% for bird in birds_in_progress %}
            <div class="bg-white rounded-xl p-4 shadow-md">
                <h3 class="text-lg font-bold text-orange-700">{{ bird.name }}</h3>
                <p class="text-sm italic text-gray-600 mb-2">{{ bird.scientific_name }}</p>
                
                <div class="flex items-center gap-2 mb-3">
                    <span class="text-sm font-medium px-2 py-0.5 rounded-full 
                        {% if bird.rarity == 'Common' %}
                            bg-green-100 text-green-800
                        {% elif bird.rarity == 'Uncommon' %}
                            bg-blue-100 text-blue-800
                        {% elif bird.rarity == 'Rare' %}
                            bg-purple-100 text-purple-800
                        {% elif bird.rarity == 'Mythical' %}
                            bg-yellow-100 text-yellow-800
                        {% else %}
                            bg-gray-100 text-gray-800
                        {% endif %}
                    ">
                        {{ bird.rarity }}
                    </span>
                </div>
                
                <div class="mb-1 flex justify-between items-center">
                    <span class="text-xs font-medium text-gray-700">Manifestation Progress</span>
                    <span class="text-xs font-medium text-gray-700">{{ bird.current_points }}/{{ bird.threshold }}</span>
                </div>
                <div class="w-full bg-gray-200 rounded-full h-2">
                    <div class="bg-blue-500 h-2 rounded-full" style="width: {{ bird.progress_percent }}%"></div>
                </div>
            </div>
            {% endfor %}
        </div>
    </div>
</div>
{% endif %}

<!-- Plants in Progress Section -->
{% if plants_in_progress %}
<div class="rounded-xl p-6 mb-8 shadow-lg border-4 border-yellow-900" style="background-image: url('/static/images/papyrus.jpg'); background-repeat: repeat;">
    <div class="border border-amber-300/50 rounded-lg p-4">
        <h2 class="text-2xl text-center text-yellow-900 mb-4 font-mystical font-bold">üå± Plants Being Manifested</h2>
        <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4">
            {% for plant in plants_in_progress %}
            <div class="bg-white rounded-xl p-4 shadow-md">
                <h3 class="text-lg font-bold text-orange-700">{{ plant.name }}</h3>
                <p class="text-sm italic text-gray-600 mb-2">{{ plant.scientific_name }}</p>
                
                <div class="flex items-center gap-2 mb-3">
                    <span class="text-sm font-medium px-2 py-0.5 rounded-full 
                        {% if plant.rarity == 'Common' %}
                            bg-green-100 text-green-800
                        {% elif plant.rarity == 'Uncommon' %}
                            bg-blue-100 text-blue-800
                        {% elif plant.rarity == 'Rare' %}
                            bg-purple-100 text-purple-800
                        {% elif plant.rarity == 'Mythical' %}
                            bg-yellow-100 text-yellow-800
                        {% else %}
                            bg-gray-100 text-gray-800
                        {% endif %}
                    ">
                        {{ plant.rarity }}
                    </span>
                </div>
                
                <div class="mb-1 flex justify-between items-center">
                    <span class="text-xs font-medium text-gray-700">Manifestation Progress</span>
                    <span class="text-xs font-medium text-gray-700">{{ plant.current_points }}/{{ plant.threshold }}</span>
                </div>
                <div class="w-full bg-gray-200 rounded-full h-2">
                    <div class="bg-green-500 h-2 rounded-full" style="width: {{ plant.progress_percent }}%"></div>
                </div>
            </div>
            {% endfor %}
        </div>
    </div>
</div>
{% endif %}
{% endblock %}
